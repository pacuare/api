{% extends "base.html" %}
{% import "forms.html" as forms %}
{% import "partials.html" as partials %}
{% block title %}Log In{% endblock title %}
{% block content %}
{% if not embedded %}
<h1 class="text-center">Log In</h1>
{% endif %}
<form x-data="loginForm" action="/v1/auth/verify" method="post">
    {% if error %}
    {% call partials.banner(danger=True) %}
    Authentication failed
    {% endcall %}
    {% endif %}
    <template x-if="error">
        {% call partials.banner(danger=True) %}
        Authentication failed
        {% endcall %}
    </template>
    <hr>
    <input type="hidden" name="return_to" value="{{ return or '/' }}">
    <fieldset>
        <label>
            Email
            <input type="email" name="email" x-model="email">
        </label>
        <template x-if="!otpVisible">
            <button @click="sendOtp" style="display:block;width:100%">Log In</button>
        </template>
        <template x-if="otpVisible">
            <div>
                <label for="code">Verification Code</label>
                {{ forms.otp_input("code") }}
                <button type="submit">Log In</button>
            </div>
        </template>
    </fieldset>
</form>
{% endblock %}

{% block scripts %}
<script src="/js/login.js"></script>
{{ forms.scripts() }}
{% endblock %}
